<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<title>ActDev - Active travel provision and potential in planned and proposed development sites.</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-title" content="ActDev" />

	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Cabin&display=swap" rel="stylesheet">

	<link rel="stylesheet" href="/js/lib/mapbox-gl-js/mapbox-gl.css" />
	<script src="/js/lib/mapbox-gl-js/mapbox-gl.min.js"></script>
	<script src="/js/lib/jquery/jquery.min.js"></script>

	<script src="/js/lib/jquery-ui/jquery-ui.min.js"></script>

	<script src="/js/lib/jQuery-Touch-Events/src/1.0.9/jquery.mobile-events.min.js"></script>

	<script src="/js/lib/mapbox-gl-draw/mapbox-gl-draw.js"></script>
	<link rel="stylesheet" href="/js/lib/mapbox-gl-draw/mapbox-gl-draw.css" />

	<script src="/js/lib/js-cookie/js.cookie.js"></script>

	<!-- Vex dialogs; see: https://github.hubspot.com/vex/ -->
	<script src="/js/lib/vex-4.1.0/dist/js/vex.combined.min.js"></script>
	<link rel="stylesheet" href="/js/lib/vex-4.1.0/dist/css/vex.css" />
	<link rel="stylesheet" href="/js/lib/vex-4.1.0/dist/css/vex-theme-plain.css" />

	<!-- GeoJSON parser for flat JSON; see: https://www.npmjs.com/package/geojson -->
	<!--<script src="https://unpkg.com/geojson@0.5.0/geojson.js"></script>-->
	<script src="/js/lib/GeoJSON.js/geojson.js"></script>

	<!-- GeoJSON extent library; see: https://github.com/mapbox/geojson-extent -->
	<script src="/js/lib/geojson-extent/geojson-extent.js"></script>

	<!-- LayerViewer library, providing the application logic -->
	<script src="/js/lib/Mapboxgljs.LayerViewer/src/layerviewer.js"></script>
	<link rel="stylesheet" type="text/css" href="/js/lib/Mapboxgljs.LayerViewer/src/layerviewer.css" />
	<script src="/js/lib/Mapboxgljs.LayerViewer/lib/geocoder.js"></script>

	<!-- Fontawesome icons -->
	<script src="/js/lib/fontawesome/fontawesome-kit-7bd5544b77.js"></script>

	<!-- Fonts -->
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@200;300;400;600;700;900&display=swap"
		rel="stylesheet">

	<!-- Parse CSV -->
	<script src="/js/lib/PapaParse/papaparse.min.js"></script>
	
	<!-- Flickity carousel -->
	<link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
	<script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>

	<!-- D3.js -->
	<script src="https://d3js.org/d3.v6.min.js"></script>

	<!-- Animate number -->
	<script src="/js/lib/jquery-animateNumber-0.0.14/jquery.animateNumber.min.js"></script>

	<!-- ActDev application and its config, implementing the LayerViewer library -->
	<script src="/.config.js"></script>
	<script src="/js/actdev.js"></script>
	<link rel="stylesheet" type="text/css" href="/css/style.css" />
	<script>
		$(function () {
			actdev.initialise(config);
		});
	</script>

<body>
	<main>
		<section class="app-container">
			<div class="infographic-half">

				<div class="infographic-header">
					
					<i class="fa fa-long-arrow-alt-left site-back-arrow"></i>
					<h1 class="site-title"></h1>

					<div class="infographic-header-container">
						<div class="infographic-header-left">
							<p class="site-description"></p>

							<ul class="external-links">
								<li><a class="site-info-link" href="#">View planning applications <i class="fa fa-chevron-right"></i></a></li>
								<li><a class="site-info-link" href="#">View simulation <i class="fa fa-chevron-right"></i></a></li>
							</ul>
						</div>

						<div class="infographic-header-right">
							<div class="ios-segmented-control">
								<span class="selection"></span>
								<div class="option">
									<input type="radio" id="current" name="current-scenario" value="current" checked>
									<label for="current"><span>Current</span></label>
								</div>
								<div class="option">
									<input type="radio" id="scenario" name="current-scenario" value="scenario">
									<label for="scenario"><span>Go Active</span></label>
								</div>
							</div>
						</div>
					</div>

					<div class="headline-stats">
						<div class="main-headline-stat site_cycle_circuity">
							<h3></h3>
							<h4>accessibility</h4>
						</div>
						<ul class="secondary-stats">
							<li class="blue site_cycle_circuity">
								<h3></h3>
								<h4>walk circuity</h4>
							</li>
							<li class="red site_walk_circuity">
								<h3></h3>
								<h4>walk circuity</h4>
							</li>
							<li class="yellow site_drive_circuity">
								<h3></h3>
								<h4>drive circuity</h4>
							</li>
						</ul>
					</div>
				</div>

				<div class="site-info-sections">
					<div class="site-info-section">
						<div class="site-info-title">
							<h4>Accessibility</h4>
							<hr>
						</div>
						<div class="site-info-content">
							<div class="graph-container">
								<img src="/images/placeholders/graph1.png" />
							</div>
							<div class="caption-container">
								Caption here & more information about the graph on the left.
							</div>
						</div>
						
					</div>

					<div class="site-info-section">
						<div class="site-info-title">
							<h4>Site data</h4>
							<hr>
						</div>
						<p class="section-description">Explanatory text here about the section</p>
						<ul class="site-data-carousel">

							<li>
								
								<div class="data-carousel-header">
									<input type="checkbox" name="desire-lines" id="desire-lines" />
									<label for="desire-lines"><img src="/images/placeholders/desire-lines.png" />
									</label>
									
									<p>Desire lines</p>
									<p class="info-circle">ⓘ</p>
								</div>
								<div class="controls"></div>
							</li>

							<li>
								<div class="data-carousel-header">
									<input type="checkbox" name="route-network" id="route-network" checked />
									<label for="route-network"><img src="/images/placeholders/route-network.png" /></label>
									<p>Route network</p>
									<p class="info-circle">ⓘ</p>
								</div>

								<div class="controls">
									<input type="radio" id="option1" name="gender" value="option1">
									<label for="male">Option 1</label><br>
									<input type="radio" id="option2" name="gender" value="option2">
									<label for="female">Option 2</label><br>
									<input type="radio" id="option3" name="gender" value="option3">
									<label for="other">Option 3</label>
								</div>
							</li>

							<li>
								<div class="data-carousel-header">
									<input type="checkbox" name="accessibility" id="accessibility" checked />
									<label for="accessibility"><img src="/images/placeholders/accessibility.png" /></label>
									<p>Accessibility</p>
									<p class="info-circle">ⓘ</p>
								</div>
								<div class="controls">
									<input type="radio" id="cycling" name="gender" value="male">
									<label for="male">Cycling</label><br>
									<input type="radio" id="walking" name="gender" value="female">
									<label for="female">Walking</label><br>
								</div>
							</li>

							<li>
								<div class="data-carousel-header">
									<input type="checkbox" name="study-area" id="study-area" />
									<label for="study-area"><img src="/images/placeholders/study-area.png" /></label>
									<p>Study area</p>
									<p class="info-circle">ⓘ</p>
								</div>
								<div class="controls"></div>
							</li>
							<li>
								<div class="data-carousel-header">
									<input type="checkbox" name="study-area" id="study-area" />
									<label for="study-area"><img src="/images/placeholders/study-area.png" /></label>
									<p>Study area</p>
									<p class="info-circle">ⓘ</p>
								</div>
								<div class="controls"></div>
							</li>
						</ul>
					</div>

					<div class="site-info-section">
						<div class="site-info-title">
							<h4>Site photos</h4>
							<hr>
						</div>
						<div class="carousel">
							<div class="carousel-cell">
								<img src="/images/placeholders/photo1.png" />
							</div>
							<div class="carousel-cell">
								<img src="/images/placeholders/photo2.png" />
							</div>
							<div class="carousel-cell">
								<img src="/images/placeholders/photo3.png" />
							</div>
							<div class="carousel-cell">
								<img src="/images/placeholders/photo4.png" />
							</div>
							<div class="carousel-cell">
								<img src="/images/placeholders/photo5.png" />
							</div>
						</div>
					</div>

				</div>
			</div>


			<div class="map-half">
				<div id="map"></div>
			</div>
		</section>

	</main>


</body>

<!-- D3 chart -->
<script>
	var chart = function () {
		const svg = d3.select(DOM.svg(width, height))
		.attr("viewBox", `${-width / 2} ${-height / 2} ${width} ${height}`)
		.style("width", "100%")
		.style("height", "auto")
		.style("font", "10px sans-serif");

		svg.append("g")
		.selectAll("g")
		.data(d3.stack().keys(data.columns.slice(1))(data))
		.join("g")
		.attr("fill", d => z(d.key))
		.selectAll("path")
		.data(d => d)
		.join("path")
		.attr("d", arc);

		svg.append("g")
		.call(xAxis);

		svg.append("g")
		.call(yAxis);

		svg.append("g")
		.call(legend);

		return svg.node();
	}
</script>


<script>
	var flky = new Flickity('.carousel', {
		// options, defaults listed

		accessibility: true,
		// enable keyboard navigation, pressing left & right keys

		adaptiveHeight: false,
		// set carousel height to the selected slide

		autoPlay: false,
		// advances to the next cell
		// if true, default is 3 seconds
		// or set time between advances in milliseconds
		// i.e. `autoPlay: 1000` will advance every 1 second

		cellAlign: 'center',
		// alignment of cells, 'center', 'left', or 'right'
		// or a decimal 0-1, 0 is beginning (left) of container, 1 is end (right)

		cellSelector: undefined,
		// specify selector for cell elements

		contain: true,
		// will contain cells to container
		// so no excess scroll at beginning or end
		// has no effect if wrapAround is enabled

		draggable: '>1',
		// enables dragging & flicking
		// if at least 2 cells

		dragThreshold: 3,
		// number of pixels a user must scroll horizontally to start dragging
		// increase to allow more room for vertical scroll for touch devices

		freeScroll: false,
		// enables content to be freely scrolled and flicked
		// without aligning cells

		friction: 0.2,
		// smaller number = easier to flick farther

		groupCells: '80%',
		// group cells together in slides

		initialIndex: 0,
		// zero-based index of the initial selected cell

		lazyLoad: true,
		// enable lazy-loading images
		// set img data-flickity-lazyload="src.jpg"
		// set to number to load images adjacent cells

		percentPosition: false,
		// sets positioning in percent values, rather than pixels
		// Enable if items have percent widths
		// Disable if items have pixel widths, like images

		prevNextButtons: true,
		// creates and enables buttons to click to previous & next cells

		pageDots: false,
		// create and enable page dots

		resize: true,
		// listens to window resize events to adjust size & positions

		rightToLeft: false,
		// enables right-to-left layout

		setGallerySize: false,
		// sets the height of gallery
		// disable if gallery already has height set with CSS

		watchCSS: false,
		// watches the content of :after of the element
		// activates if #element:after { content: 'flickity' }

		wrapAround: false
		// at end of cells, wraps-around to first for infinite scrolling

	});
</script>

<!-- iOS control script -->
<script>
	// Constants
	const SEGMENTED_CONTROL_BASE_SELECTOR = ".ios-segmented-control";
	const SEGMENTED_CONTROL_INDIVIDUAL_SEGMENT_SELECTOR = ".ios-segmented-control .option input";
	const SEGMENTED_CONTROL_BACKGROUND_PILL_SELECTOR = ".ios-segmented-control .selection";


	// Main
	document.addEventListener("DOMContentLoaded", setup);

	// Body functions
	function setup() {
		forEachElement(SEGMENTED_CONTROL_BASE_SELECTOR, elem => {
			elem.addEventListener("change", updatePillPosition);
		})
		window.addEventListener("resize",
			updatePillPosition
			); // Prevent pill from detaching from element when window resized. Becuase this is rare I haven't bothered with throttling the event
	}

	function updatePillPosition() {
		forEachElement(SEGMENTED_CONTROL_INDIVIDUAL_SEGMENT_SELECTOR, (elem, index) => {
			if (elem.checked) moveBackgroundPillToElement(elem, index);
		})
	}

	function moveBackgroundPillToElement(elem, index) {
		document.querySelector(SEGMENTED_CONTROL_BACKGROUND_PILL_SELECTOR).style.transform = "translateX(" + (elem
			.offsetWidth * index) + "px)";
	}

	// Helper functions

	function forEachElement(className, fn) {
		Array.from(document.querySelectorAll(className)).forEach(fn);
	}
</script>

</html>